
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/assisted/plot_b05alt_spec_segmentation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_assisted_plot_b05alt_spec_segmentation.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_assisted_plot_b05alt_spec_segmentation.py:


Segmentations and alternative specific specification
====================================================

We consider 4 specifications for the constants:

- Not segmented
- Segmented by GA (yearly subscription to public transport)
- Segmented by luggage
- Segmented both by GA and luggage

We consider 6 specifications for the time coefficients:

- Generic and not segmented
- Generic and segmented with first class
- Generic and segmented with trip purpose
- Alternative specific and not segmented
- Alternative specific and segmented with first class
- Alternative specific and segmented with trip purpose

We consider 2 specifications for the cost coefficients:

- Generic
- Alternative specific

We obtain a total of 48 specifications.
See `Bierlaire and Ortelli (2023)
<https://transp-or.epfl.ch/documents/technicalReports/BierOrte23.pdf>`_.

:author: Michel Bierlaire, EPFL
:date: Thu Jul 13 16:18:10 2023

.. GENERATED FROM PYTHON SOURCE LINES 35-59

.. code-block:: Python


    import numpy as np
    from IPython.core.display_functions import display

    import biogeme.biogeme as bio
    from biogeme import models
    from biogeme.expressions import Beta
    from biogeme.catalog import segmentation_catalogs, generic_alt_specific_catalogs
    from biogeme.results import compile_estimation_results, pareto_optimal

    from biogeme.data.swissmetro import (
        read_data,
        CHOICE,
        SM_AV,
        CAR_AV_SP,
        TRAIN_AV_SP,
        TRAIN_TT_SCALED,
        TRAIN_COST_SCALED,
        SM_TT_SCALED,
        SM_COST_SCALED,
        CAR_TT_SCALED,
        CAR_CO_SCALED,
    )








.. GENERATED FROM PYTHON SOURCE LINES 60-61

Read the data

.. GENERATED FROM PYTHON SOURCE LINES 61-63

.. code-block:: Python

    database = read_data()








.. GENERATED FROM PYTHON SOURCE LINES 64-65

Definition of the segmentations.

.. GENERATED FROM PYTHON SOURCE LINES 65-78

.. code-block:: Python

    segmentation_ga = database.generate_segmentation(
        variable='GA', mapping={0: 'noGA', 1: 'GA'}
    )

    segmentation_luggage = database.generate_segmentation(
        variable='LUGGAGE', mapping={0: 'no_lugg', 1: 'one_lugg', 3: 'several_lugg'}
    )

    segmentation_first = database.generate_segmentation(
        variable='FIRST', mapping={0: '2nd_class', 1: '1st_class'}
    )









.. GENERATED FROM PYTHON SOURCE LINES 79-81

We consider two trip purposes: 'commuters' and anything else. We
need to define a binary variable first.

.. GENERATED FROM PYTHON SOURCE LINES 81-87

.. code-block:: Python

    database.data['COMMUTERS'] = np.where(database.data['PURPOSE'] == 1, 1, 0)

    segmentation_purpose = database.generate_segmentation(
        variable='COMMUTERS', mapping={0: 'non_commuters', 1: 'commuters'}
    )








.. GENERATED FROM PYTHON SOURCE LINES 88-89

Parameters to be estimated.

.. GENERATED FROM PYTHON SOURCE LINES 89-94

.. code-block:: Python

    ASC_CAR = Beta('ASC_CAR', 0, None, None, 0)
    ASC_TRAIN = Beta('ASC_TRAIN', 0, None, None, 0)
    B_TIME = Beta('B_TIME', 0, None, None, 0)
    B_COST = Beta('B_COST', 0, None, None, 0)








.. GENERATED FROM PYTHON SOURCE LINES 95-96

Catalogs for the alternative specific constants.

.. GENERATED FROM PYTHON SOURCE LINES 96-107

.. code-block:: Python

    ASC_TRAIN_catalog, ASC_CAR_catalog = segmentation_catalogs(
        generic_name='ASC',
        beta_parameters=[ASC_TRAIN, ASC_CAR],
        potential_segmentations=(
            segmentation_ga,
            segmentation_luggage,
        ),
        maximum_number=2,
    )









.. GENERATED FROM PYTHON SOURCE LINES 108-112

Catalog for the travel time coefficient.
Note that the function returns a list of catalogs. Here, the list
contains only one of them.  This is why there is a comma after
"B_TIME_catalog".

.. GENERATED FROM PYTHON SOURCE LINES 112-123

.. code-block:: Python

    (B_TIME_catalog_dict,) = generic_alt_specific_catalogs(
        generic_name='B_TIME',
        beta_parameters=[B_TIME],
        alternatives=('TRAIN', 'SM', 'CAR'),
        potential_segmentations=(
            segmentation_first,
            segmentation_purpose,
        ),
        maximum_number=1,
    )








.. GENERATED FROM PYTHON SOURCE LINES 124-125

Catalog for the travel cost coefficient.

.. GENERATED FROM PYTHON SOURCE LINES 125-129

.. code-block:: Python

    (B_COST_catalog_dict,) = generic_alt_specific_catalogs(
        generic_name='B_COST', beta_parameters=[B_COST], alternatives=('TRAIN', 'SM', 'CAR')
    )








.. GENERATED FROM PYTHON SOURCE LINES 130-131

Definition of the utility functions.

.. GENERATED FROM PYTHON SOURCE LINES 131-146

.. code-block:: Python

    V1 = (
        ASC_TRAIN_catalog
        + B_TIME_catalog_dict['TRAIN'] * TRAIN_TT_SCALED
        + B_COST_catalog_dict['TRAIN'] * TRAIN_COST_SCALED
    )
    V2 = (
        B_TIME_catalog_dict['SM'] * SM_TT_SCALED
        + B_COST_catalog_dict['SM'] * SM_COST_SCALED
    )
    V3 = (
        ASC_CAR_catalog
        + B_TIME_catalog_dict['CAR'] * CAR_TT_SCALED
        + B_COST_catalog_dict['CAR'] * CAR_CO_SCALED
    )








.. GENERATED FROM PYTHON SOURCE LINES 147-148

Associate utility functions with the numbering of alternatives.

.. GENERATED FROM PYTHON SOURCE LINES 148-150

.. code-block:: Python

    V = {1: V1, 2: V2, 3: V3}








.. GENERATED FROM PYTHON SOURCE LINES 151-152

Associate the availability conditions with the alternatives.

.. GENERATED FROM PYTHON SOURCE LINES 152-154

.. code-block:: Python

    av = {1: TRAIN_AV_SP, 2: SM_AV, 3: CAR_AV_SP}








.. GENERATED FROM PYTHON SOURCE LINES 155-157

Definition of the model. This is the contribution of each
observation to the log likelihood function.

.. GENERATED FROM PYTHON SOURCE LINES 157-159

.. code-block:: Python

    logprob = models.loglogit(V, av, CHOICE)








.. GENERATED FROM PYTHON SOURCE LINES 160-161

Create the Biogeme object.

.. GENERATED FROM PYTHON SOURCE LINES 161-166

.. code-block:: Python

    the_biogeme = bio.BIOGEME(database, logprob)
    the_biogeme.modelName = 'b05alt_spec_segmentation'
    the_biogeme.generate_html = False
    the_biogeme.generate_pickle = False








.. GENERATED FROM PYTHON SOURCE LINES 167-168

Estimate the parameters.

.. GENERATED FROM PYTHON SOURCE LINES 168-170

.. code-block:: Python

    dict_of_results = the_biogeme.estimate_catalog()








.. GENERATED FROM PYTHON SOURCE LINES 171-172

Number of estimated models.

.. GENERATED FROM PYTHON SOURCE LINES 172-174

.. code-block:: Python

    print(f'A total of {len(dict_of_results)} models have been estimated')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    A total of 48 models have been estimated




.. GENERATED FROM PYTHON SOURCE LINES 175-176

All estimation results

.. GENERATED FROM PYTHON SOURCE LINES 176-180

.. code-block:: Python

    compiled_results, specs = compile_estimation_results(
        dict_of_results, use_short_names=True
    )








.. GENERATED FROM PYTHON SOURCE LINES 181-183

.. code-block:: Python

    display(compiled_results)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

                                         Model_000000  ...      Model_000047
    Number of estimated parameters                 12  ...                 7
    Sample size                                 10719  ...             10719
    Final log likelihood                 -8365.232835  ...      -8257.106047
    Akaike Information Criterion         16754.465669  ...      16528.212095
    Bayesian Information Criterion       16841.822947  ...      16579.170507
    ASC_CAR (t-test)                  -0.549  (-7.08)  ...  0.00577  (0.145)
    ASC_CAR_one_lugg (t-test)        -0.0993  (-1.98)  ...                  
    ASC_CAR_several_lugg (t-test)      -0.51  (-2.44)  ...                  
    ASC_TRAIN (t-test)                -0.672  (-6.54)  ...    -1.17  (-18.4)
    ASC_TRAIN_one_lugg (t-test)         0.772  (9.72)  ...                  
    ASC_TRAIN_several_lugg (t-test)     0.669  (3.73)  ...                  
    B_COST_CAR (t-test)               -0.643  (-6.44)  ...                  
    B_COST_SM (t-test)                -0.784  (-14.9)  ...                  
    B_COST_TRAIN (t-test)                 -1.7  (-14)  ...                  
    B_TIME_CAR (t-test)                  -1.06  (-11)  ...                  
    B_TIME_SM (t-test)                 -1.47  (-14.4)  ...                  
    B_TIME_TRAIN (t-test)               -1.4  (-16.2)  ...                  
    B_COST (t-test)                                    ...   -0.783  (-13.4)
    B_TIME (t-test)                                    ...   -0.868  (-10.2)
    B_TIME_1st_class (t-test)                          ...   -0.619  (-8.43)
    B_TIME_commuters (t-test)                          ...                  
    B_TIME_CAR_1st_class (t-test)                      ...                  
    B_TIME_SM_1st_class (t-test)                       ...                  
    B_TIME_TRAIN_1st_class (t-test)                    ...                  
    ASC_CAR_GA (t-test)                                ...    -1.24  (-7.99)
    ASC_TRAIN_GA (t-test)                              ...      1.49  (21.7)
    B_TIME_CAR_commuters (t-test)                      ...                  
    B_TIME_SM_commuters (t-test)                       ...                  
    B_TIME_TRAIN_commuters (t-test)                    ...                  

    [29 rows x 48 columns]




.. GENERATED FROM PYTHON SOURCE LINES 184-185

Glossary

.. GENERATED FROM PYTHON SOURCE LINES 185-188

.. code-block:: Python

    for short_name, spec in specs.items():
        print(f'{short_name}\t{spec}')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Model_000000    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000001    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000002    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000003    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000004    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000005    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000006    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000007    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000008    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000009    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000010    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000011    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000012    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000013    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000014    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000015    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000016    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000017    ASC:GA;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000018    ASC:GA;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000019    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000020    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000021    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000022    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000023    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000024    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000025    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000026    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000027    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000028    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000029    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000030    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000031    ASC:GA;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000032    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000033    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000034    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000035    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000036    ASC:GA;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000037    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000038    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000039    ASC:LUGGAGE;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000040    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000041    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:altspec
    Model_000042    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000043    ASC:no_seg;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000044    ASC:LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:generic
    Model_000045    ASC:GA;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:altspec
    Model_000046    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000047    ASC:GA;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic




.. GENERATED FROM PYTHON SOURCE LINES 189-190

Estimation results of the Pareto optimal models.

.. GENERATED FROM PYTHON SOURCE LINES 190-195

.. code-block:: Python

    pareto_results = pareto_optimal(dict_of_results)
    compiled_pareto_results, pareto_specs = compile_estimation_results(
        pareto_results, use_short_names=True
    )








.. GENERATED FROM PYTHON SOURCE LINES 196-198

.. code-block:: Python

    display(compiled_pareto_results)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

                                        Model_000000  ...     Model_000008
    Number of estimated parameters                 6  ...                5
    Sample size                                10719  ...            10719
    Final log likelihood                -8313.612717  ...     -8598.531031
    Akaike Information Criterion        16639.225434  ...     17207.062062
    Bayesian Information Criterion      16682.904073  ...     17243.460927
    ASC_CAR (t-test)                 0.0143  (0.361)  ...  0.0091  (0.245)
    ASC_CAR_GA (t-test)               -1.26  (-8.18)  ...                 
    ASC_TRAIN (t-test)                -1.12  (-18.2)  ...  -0.707  (-12.5)
    ASC_TRAIN_GA (t-test)               1.52  (22.1)  ...                 
    B_COST (t-test)                  -0.704  (-13.3)  ...   -0.87  (-15.6)
    B_TIME (t-test)                   -1.19  (-18.3)  ...  -0.916  (-10.9)
    ASC_CAR_one_lugg (t-test)                         ...                 
    ASC_CAR_several_lugg (t-test)                     ...                 
    ASC_TRAIN_one_lugg (t-test)                       ...                 
    ASC_TRAIN_several_lugg (t-test)                   ...                 
    B_TIME_CAR (t-test)                               ...                 
    B_TIME_CAR_commuters (t-test)                     ...                 
    B_TIME_SM (t-test)                                ...                 
    B_TIME_SM_commuters (t-test)                      ...                 
    B_TIME_TRAIN (t-test)                             ...                 
    B_TIME_TRAIN_commuters (t-test)                   ...                 
    B_COST_CAR (t-test)                               ...                 
    B_COST_SM (t-test)                                ...                 
    B_COST_TRAIN (t-test)                             ...                 
    B_TIME_1st_class (t-test)                         ...  -0.688  (-9.57)

    [25 rows x 9 columns]




.. GENERATED FROM PYTHON SOURCE LINES 199-200

Glossary.

.. GENERATED FROM PYTHON SOURCE LINES 200-202

.. code-block:: Python

    for short_name, spec in pareto_specs.items():
        print(f'{short_name}\t{spec}')




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Model_000000    ASC:GA;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000001    ASC:GA-LUGGAGE;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000002    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000003    ASC:GA;B_COST_gen_altspec:generic;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000004    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:no_seg;B_TIME_gen_altspec:generic
    Model_000005    ASC:GA-LUGGAGE;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000006    ASC:GA;B_COST_gen_altspec:altspec;B_TIME:COMMUTERS;B_TIME_gen_altspec:altspec
    Model_000007    ASC:GA;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic
    Model_000008    ASC:no_seg;B_COST_gen_altspec:generic;B_TIME:FIRST;B_TIME_gen_altspec:generic





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 21.509 seconds)


.. _sphx_glr_download_auto_examples_assisted_plot_b05alt_spec_segmentation.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_b05alt_spec_segmentation.ipynb <plot_b05alt_spec_segmentation.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_b05alt_spec_segmentation.py <plot_b05alt_spec_segmentation.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_b05alt_spec_segmentation.zip <plot_b05alt_spec_segmentation.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
